# Lab 3 – Weekly Sales Mart

## Purpose
Витрина данных в схеме `dm` внутри базы `dwh`, предоставляющая продажи по неделям и филиалам для простой аналитики.

## Скрипты
- `lab3-create.sql` — создаёт схему `dm`, таблицы `dim_week` и `fact_weekly_sales` без дополнительных триггеров.
- `lab3-insert.sql` — очищает витрину и заполняет её, агрегируя данные напрямую из таблиц `dwh` (сумма считается как `quantity * unit_price`, без FDW).

## Что показать на защите
1. Структура витрины (`\d dm.fact_weekly_sales`) и связь с таблицами `dwh`.
2. Пример агрегации: `SELECT * FROM dm.fact_weekly_sales ORDER BY week_key, branch_name;`.
3. Повторная загрузка витрины — данные пересчитываются без дублей, `load_date` обновляется.
